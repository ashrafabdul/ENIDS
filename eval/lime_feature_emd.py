from pyemd import emd
import pandas as pd
from scipy.spatial.distance import cdist, squareform
import numpy as np
from itertools import product

BASEPATH = '/home/aabdul/projects/enids/data/NSL-KDD/report/lime/'

if __name__=="__main__":


    acs = ['dos', 'normal', 'probe', 'r2l', 'u2r']
    ranks = list(range(1, 41))
    ranks = list(zip(ranks,[0]*40))
    ranks = np.array(ranks)
    #print(ranks)
    dm = cdist(ranks,ranks,metric='minkowski',p=1)
    #print(dm)

    for ac in acs:
        emds = []
        df_mtl = pd.read_csv(BASEPATH+'mtl_'+ac+'_feature_rank_distribution.csv')
        df_mlp = pd.read_csv(BASEPATH + 'mlp_' + ac + '_feature_rank_distribution.csv')
        features = df_mtl.columns
        for feature in features:
            mtl_pd = (df_mtl[feature] / df_mtl[feature].sum() ).as_matrix()
            mlp_pd = (df_mlp[feature] / df_mlp[feature].sum()).as_matrix()
            emdist = emd(mtl_pd,mlp_pd,dm)
            emds.append([feature,emdist])
        df_emd = pd.DataFrame(emds,columns=['feature','distance'])
        df_emd.to_csv(BASEPATH+'lime_'+ac+'_fimp_distances.csv',index=False)



 #    np.set_printoptions(threshold=100000)
 #    first_signature = np.array([  0.00000000e+00,   0.00000000e+00,   4.00000000e+00,   9.00000000e+00,
 #   6.00000000e+00,   9.00000000e+00,   2.00000000e+00,   0.00000000e+00,
 #   1.00000000e+00,   1.00000000e+00,   0.00000000e+00,   0.00000000e+00,
 #   2.00000000e+00, 1.50000000e+01,   2.00000000e+01,   2.80000000e+01,
 #   7.00000000e+01,   4.10000000e+01,   2.70000000e+01,   3.56000000e+02,
 #   6.60000000e+01,   1.07280000e+04,   2.14300000e+03,  1.64400000e+03,
 #   5.53000000e+02,   5.16000000e+02,   7.72000000e+02,   1.09500000e+03,
 #   1.69000000e+02,   1.55000000e+02,   1.54000000e+02,   5.90000000e+01,
 #   1.35000000e+02,   2.28000000e+02,   5.11000000e+02,   1.21400000e+03,
 #   2.70400000e+03,   3.57000000e+03,   2.12500000e+03,   5.72000000e+02])
 #    second_signature = np.array([  0.00000000e+00,   0.00000000e+00,   4.00000000e+00,   9.00000000e+00,
 #   6.00000000e+00,   9.00000000e+00,   2.00000000e+00,   0.00000000e+00,
 #   1.00000000e+00,   1.00000000e+00,   0.00000000e+00,   0.00000000e+00,
 #   2.00000000e+00,   1.50000000e+01,   2.00000000e+01,   2.80000000e+01,
 #   7.00000000e+01,   4.10000000e+01,   2.70000000e+01,   3.56000000e+02,
 #   6.60000000e+01,   1.07280000e+04,   2.14300000e+03,   1.64400000e+03,
 #   5.53000000e+02,   5.16000000e+02,   7.72000000e+02,   1.09500000e+03,
 #   1.69000000e+02,   1.55000000e+02,   1.54000000e+02,   5.90000000e+01,
 #   1.35000000e+02,   2.28000000e+02,   5.11000000e+02,   1.21400000e+03,
 #   2.70400000e+03,   3.57000000e+03,   2.12500000e+03,   5.72000000e+02])
 #    distance_matrix = np.array([[  0.0,   1.0,   2.0,   3.0,   4.0,   5.0,   6.0,   7.0,   8.0,   9.0,  10.0,  11.0,  12.0,  13.0,
 #   14.0,  15.0,  16.0,  17.0,  18.0,  19.0,  20.0,  21.0,  22.0,  23.0,  24.0,  25.0,  26.0,  27.0,
 #   28.0,  29.0,  30.0,  31.0,  32.0,  33.0,  34.0,  35.0,  36.0,  37.0,  38.0,  39.0],
 # [  1.0,   0.0,   1.0,   2.0,   3.0,   4.0,   5.0,   6.0,   7.0,   8.0,   9.0,  10.0,  11.0,  12.0,
 #   13.0,  14.0,  15.0,  16.0,  17.0,  18.0,  19.0,  20.0,  21.0,  22.0,  23.0,  24.0,  25.0,  26.0,
 #   27.0,  28.0,  29.0,  30.0,  31.0,  32.0,  33.0,  34.0,  35.0,  36.0,  37.0,  38.0],
 # [  2.0,   1.0,   0.0,   1.0,   2.0,   3.0,   4.0,   5.0,   6.0,   7.0,   8.0,   9.0,  10.0,  11.0,
 #   12.0,  13.0,  14.0,  15.0,  16.0,  17.0,  18.0,  19.0,  20.0,  21.0,  22.0,  23.0,  24.0,  25.0,
 #   26.0,  27.0,  28.0,  29.0,  30.0,  31.0,  32.0,  33.0,  34.0,  35.0,  36.0,  37.0],
 # [  3.0,   2.0,   1.0,   0.0,   1.0,   2.0,   3.0,   4.0,   5.0,   6.0,   7.0,   8.0,   9.0,  10.0,
 #   11.0,  12.0,  13.0,  14.0,  15.0,  16.0,  17.0,  18.0,  19.0,  20.0,  21.0,  22.0,  23.0,  24.0,
 #   25.0,  26.0,  27.0,  28.0,  29.0,  30.0,  31.0,  32.0,  33.0,  34.0,  35.0,  36.0],
 # [  4.0,   3.0,   2.0,   1.0,   0.0,   1.0,   2.0,   3.0,   4.0,   5.0,   6.0,   7.0,   8.0,   9.0,
 #   10.0,  11.0,  12.0,  13.0,  14.0,  15.0,  16.0,  17.0,  18.0,  19.0,  20.0,  21.0,  22.0,  23.0,
 #   24.0,  25.0,  26.0,  27.0,  28.0,  29.0,  30.0,  31.0,  32.0,  33.0,  34.0,  35.0],
 # [  5.0,   4.0,   3.0,   2.0,   1.0,   0.0,   1.0,   2.0,   3.0,   4.0,   5.0,   6.0,   7.0,   8.0,
 #    9.0,  10.0,  11.0,  12.0,  13.0,  14.0,  15.0,  16.0,  17.0,  18.0,  19.0,  20.0,  21.0,  22.0,
 #   23.0,  24.0,  25.0,  26.0,  27.0,  28.0,  29.0,  30.0,  31.0,  32.0,  33.0,  34.0],
 # [  6.0,   5.0,   4.0,   3.0,   2.0,   1.0,   0.0,   1.0,   2.0,   3.0,   4.0,   5.0,   6.0,   7.0,
 #    8.0,   9.0,  10.0,  11.0,  12.0,  13.0,  14.0,  15.0,  16.0,  17.0,  18.0,  19.0,  20.0,  21.0,
 #   22.0,  23.0,  24.0,  25.0,  26.0,  27.0,  28.0,  29.0,  30.0,  31.0,  32.0,  33.0],
 # [  7.0,   6.0,   5.0,   4.0,   3.0,   2.0,   1.0,   0.0,   1.0,   2.0,   3.0,   4.0,   5.0,   6.0,
 #    7.0,   8.0,   9.0,  10.0,  11.0,  12.0,  13.0,  14.0,  15.0,  16.0,  17.0,  18.0,  19.0,  20.0,
 #   21.0,  22.0,  23.0,  24.0,  25.0,  26.0,  27.0,  28.0,  29.0,  30.0,  31.0,  32.0],
 # [  8.0,   7.0,   6.0,   5.0,   4.0,   3.0,   2.0,   1.0,   0.0,   1.0,   2.0,   3.0,   4.0,   5.0,
 #    6.0,   7.0,   8.0,   9.0,  10.0,  11.0,  12.0,  13.0,  14.0,  15.0,  16.0,  17.0,  18.0,  19.0,
 #   20.0,  21.0,  22.0,  23.0,  24.0,  25.0,  26.0,  27.0,  28.0,  29.0,  30.0,  31.0],
 # [  9.0,   8.0,   7.0,   6.0,   5.0,   4.0,   3.0,   2.0,   1.0,   0.0,   1.0,   2.0,   3.0,   4.0,
 #    5.0,   6.0,   7.0,   8.0,   9.0,  10.0,  11.0,  12.0,  13.0,  14.0,  15.0,  16.0,  17.0,  18.0,
 #   19.0,  20.0,  21.0,  22.0,  23.0,  24.0,  25.0,  26.0,  27.0,  28.0,  29.0,  30.0],
 # [ 10.0,   9.0,   8.0,   7.0,   6.0,   5.0,   4.0,   3.0,   2.0,   1.0,   0.0,   1.0,   2.0,   3.0,
 #    4.0,   5.0,   6.0,   7.0,   8.0,   9.0,  10.0,  11.0,  12.0,  13.0,  14.0,  15.0,  16.0,  17.0,
 #   18.0,  19.0,  20.0,  21.0,  22.0,  23.0,  24.0,  25.0,  26.0,  27.0,  28.0,  29.0],
 # [ 11.0,  10.0,   9.0,   8.0,   7.0,   6.0,   5.0,   4.0,   3.0,   2.0,   1.0,   0.0,   1.0,   2.0,
 #    3.0,   4.0,   5.0,   6.0,   7.0,   8.0,   9.0,  10.0,  11.0,  12.0,  13.0,  14.0,  15.0,  16.0,
 #   17.0,  18.0,  19.0,  20.0,  21.0,  22.0,  23.0,  24.0,  25.0,  26.0,  27.0,  28.0],
 # [ 12.0,  11.0,  10.0,   9.0,   8.0,   7.0,   6.0,   5.0,   4.0,   3.0,   2.0,   1.0,   0.0,   1.0,
 #    2.0,   3.0,   4.0,   5.0,   6.0,   7.0,   8.0,   9.0,  10.0,  11.0,  12.0,  13.0,  14.0,  15.0,
 #   16.0,  17.0,  18.0,  19.0,  20.0,  21.0,  22.0,  23.0,  24.0,  25.0,  26.0,  27.0],
 # [ 13.0,  12.0,  11.0,  10.0,   9.0,   8.0,   7.0,   6.0,   5.0,   4.0,   3.0,   2.0,   1.0,   0.0,
 #    1.0,   2.0,   3.0,   4.0,   5.0,   6.0,   7.0,   8.0,   9.0,  10.0,  11.0,  12.0,  13.0,  14.0,
 #   15.0,  16.0,  17.0,  18.0,  19.0,  20.0,  21.0,  22.0,  23.0,  24.0,  25.0,  26.0],
 # [ 14.0,  13.0,  12.0,  11.0,  10.0,   9.0,   8.0,   7.0,   6.0,   5.0,   4.0,   3.0,   2.0,   1.0,
 #    0.0,   1.0,   2.0,   3.0,   4.0,   5.0,   6.0,   7.0,   8.0,   9.0,  10.0,  11.0,  12.0,  13.0,
 #   14.0,  15.0,  16.0,  17.0,  18.0,  19.0,  20.0,  21.0,  22.0,  23.0,  24.0,  25.0],
 # [ 15.0,  14.0,  13.0,  12.0,  11.0,  10.0,   9.0,   8.0,   7.0,   6.0,   5.0,   4.0,   3.0,   2.0,
 #    1.0,   0.0,   1.0,   2.0,   3.0,   4.0,   5.0,   6.0,   7.0,   8.0,   9.0,  10.0,  11.0,  12.0,
 #   13.0,  14.0,  15.0,  16.0,  17.0,  18.0,  19.0,  20.0,  21.0,  22.0,  23.0,  24.0],
 # [ 16.0,  15.0,  14.0,  13.0,  12.0,  11.0,  10.0,   9.0,   8.0,   7.0,   6.0,   5.0,   4.0,   3.0,
 #    2.0,   1.0,   0.0,   1.0,   2.0,   3.0,   4.0,   5.0,   6.0,   7.0,   8.0,   9.0,  10.0,  11.0,
 #   12.0,  13.0,  14.0,  15.0,  16.0,  17.0,  18.0,  19.0,  20.0,  21.0,  22.0,  23.0],
 # [ 17.0,  16.0,  15.0,  14.0,  13.0,  12.0,  11.0,  10.0,   9.0,   8.0,   7.0,   6.0,   5.0,   4.0,
 #    3.0,   2.0,   1.0,   0.0,   1.0,   2.0,   3.0,   4.0,   5.0,   6.0,   7.0,   8.0,   9.0,  10.0,
 #   11.0,  12.0,  13.0,  14.0,  15.0,  16.0,  17.0,  18.0,  19.0,  20.0,  21.0,  22.0],
 # [ 18.0,  17.0,  16.0,  15.0,  14.0,  13.0,  12.0,  11.0,  10.0,   9.0,   8.0,   7.0,   6.0,   5.0,
 #    4.0,   3.0,   2.0,   1.0,   0.0,   1.0,   2.0,   3.0,   4.0,   5.0,   6.0,   7.0,   8.0,   9.0,
 #   10.0,  11.0,  12.0,  13.0,  14.0,  15.0,  16.0,  17.0,  18.0,  19.0,  20.0,  21.0],
 # [ 19.0,  18.0,  17.0,  16.0,  15.0,  14.0,  13.0,  12.0,  11.0,  10.0,   9.0,   8.0,   7.0,   6.0,
 #    5.0,   4.0,   3.0,   2.0,   1.0,   0.0,   1.0,   2.0,   3.0,   4.0,   5.0,   6.0,   7.0,   8.0,
 #    9.0,  10.0,  11.0,  12.0,  13.0,  14.0,  15.0,  16.0,  17.0,  18.0,  19.0,  20.0],
 # [ 20.0,  19.0,  18.0,  17.0,  16.0,  15.0,  14.0,  13.0,  12.0,  11.0,  10.0,   9.0,   8.0,   7.0,
 #    6.0,   5.0,   4.0,   3.0,   2.0,   1.0,   0.0,   1.0,   2.0,   3.0,   4.0,   5.0,   6.0,   7.0,
 #    8.0,   9.0,  10.0,  11.0,  12.0,  13.0,  14.0,  15.0,  16.0,  17.0,  18.0,  19.0],
 # [ 21.0,  20.0,  19.0,  18.0,  17.0,  16.0,  15.0,  14.0,  13.0,  12.0,  11.0,  10.0,   9.0,   8.0,
 #    7.0,   6.0,   5.0,   4.0,   3.0,   2.0,   1.0,   0.0,   1.0,   2.0,   3.0,   4.0,   5.0,   6.0,
 #    7.0,   8.0,   9.0,  10.0,  11.0,  12.0,  13.0,  14.0,  15.0,  16.0,  17.0,  18.0],
 # [ 22.0,  21.0,  20.0,  19.0,  18.0,  17.0,  16.0,  15.0,  14.0,  13.0,  12.0,  11.0,  10.0,   9.0,
 #    8.0,   7.0,   6.0,   5.0,   4.0,   3.0,   2.0,   1.0,   0.0,   1.0,   2.0,   3.0,   4.0,   5.0,
 #    6.0,   7.0,   8.0,   9.0,  10.0,  11.0,  12.0,  13.0,  14.0,  15.0,  16.0,  17.0],
 # [ 23.0,  22.0,  21.0,  20.0,  19.0,  18.0,  17.0,  16.0,  15.0,  14.0,  13.0,  12.0,  11.0,  10.0,
 #    9.0,   8.0,   7.0,   6.0,   5.0,   4.0,   3.0,   2.0,   1.0,   0.0,   1.0,   2.0,   3.0,   4.0,
 #    5.0,   6.0,   7.0,   8.0,   9.0,  10.0,  11.0,  12.0,  13.0,  14.0,  15.0,  16.0],
 # [ 24.0,  23.0,  22.0,  21.0,  20.0,  19.0,  18.0,  17.0,  16.0,  15.0,  14.0,  13.0,  12.0,  11.0,
 #   10.0,   9.0,   8.0,   7.0,   6.0,   5.0,   4.0,   3.0,   2.0,   1.0,   0.0,   1.0,   2.0,   3.0,
 #    4.0,   5.0,   6.0,   7.0,   8.0,   9.0,  10.0,  11.0,  12.0,  13.0,  14.0,  15.0],
 # [ 25.0,  24.0,  23.0,  22.0,  21.0,  20.0,  19.0,  18.0,  17.0,  16.0,  15.0,  14.0,  13.0,  12.0,
 #   11.0,  10.0,   9.0,   8.0,   7.0,   6.0,   5.0,   4.0,   3.0,   2.0,   1.0,   0.0,   1.0,   2.0,
 #    3.0,   4.0,   5.0,   6.0,   7.0,   8.0,   9.0,  10.0,  11.0,  12.0,  13.0,  14.0],
 # [ 26.0,  25.0,  24.0,  23.0,  22.0,  21.0,  20.0,  19.0,  18.0,  17.0,  16.0,  15.0,  14.0,  13.0,
 #   12.0,  11.0,  10.0,   9.0,   8.0,   7.0,   6.0,   5.0,   4.0,   3.0,   2.0,   1.0,   0.0,   1.0,
 #    2.0,   3.0,   4.0,   5.0,   6.0,   7.0,   8.0,   9.0,  10.0,  11.0,  12.0,  13.0],
 # [ 27.0,  26.0,  25.0,  24.0,  23.0,  22.0,  21.0,  20.0,  19.0,  18.0,  17.0,  16.0,  15.0,  14.0,
 #   13.0,  12.0,  11.0,  10.0,   9.0,   8.0,   7.0,   6.0,   5.0,   4.0,   3.0,   2.0,   1.0,   0.0,
 #    1.0,   2.0,   3.0,   4.0,   5.0,   6.0,   7.0,   8.0,   9.0,  10.0,  11.0,  12.0],
 # [ 28.0,  27.0,  26.0,  25.0,  24.0,  23.0,  22.0,  21.0,  20.0,  19.0,  18.0,  17.0,  16.0,  15.0,
 #   14.0,  13.0,  12.0,  11.0,  10.0,   9.0,   8.0,   7.0,   6.0,   5.0,   4.0,   3.0,   2.0,   1.0,
 #    0.0,   1.0,   2.0,   3.0,   4.0,   5.0,   6.0,   7.0,   8.0,   9.0,  10.0,  11.0],
 # [ 29.0,  28.0,  27.0,  26.0,  25.0,  24.0,  23.0,  22.0,  21.0,  20.0,  19.0,  18.0,  17.0,  16.0,
 #   15.0,  14.0,  13.0,  12.0,  11.0,  10.0,   9.0,   8.0,   7.0,   6.0,   5.0,   4.0,   3.0,   2.0,
 #    1.0,   0.0,   1.0,   2.0,   3.0,   4.0,   5.0,   6.0,   7.0,   8.0,   9.0,  10.0],
 # [ 30.0,  29.0,  28.0,  27.0,  26.0,  25.0,  24.0,  23.0,  22.0,  21.0,  20.0,  19.0,  18.0,  17.0,
 #   16.0,  15.0,  14.0,  13.0,  12.0,  11.0,  10.0,   9.0,   8.0,   7.0,   6.0,   5.0,   4.0,   3.0,
 #    2.0,   1.0,   0.0,   1.0,   2.0,   3.0,   4.0,   5.0,   6.0,   7.0,   8.0,   9.0],
 # [ 31.0,  30.0,  29.0,  28.0,  27.0,  26.0,  25.0,  24.0,  23.0,  22.0,  21.0,  20.0,  19.0,  18.0,
 #   17.0,  16.0,  15.0,  14.0,  13.0,  12.0,  11.0,  10.0,   9.0,   8.0,   7.0,   6.0,   5.0,   4.0,
 #    3.0,   2.0,   1.0,   0.0,   1.0,   2.0,   3.0,   4.0,   5.0,   6.0,   7.0,   8.0],
 # [ 32.0,  31.0,  30.0,  29.0,  28.0,  27.0,  26.0,  25.0,  24.0,  23.0,  22.0,  21.0,  20.0,  19.0,
 #   18.0,  17.0,  16.0,  15.0,  14.0,  13.0,  12.0,  11.0,  10.0,   9.0,   8.0,   7.0,   6.0,   5.0,
 #    4.0,   3.0,   2.0,   1.0,   0.0,   1.0,   2.0,   3.0,   4.0,   5.0,   6.0,   7.0],
 # [ 33.0,  32.0,  31.0,  30.0,  29.0,  28.0,  27.0,  26.0,  25.0,  24.0,  23.0,  22.0,  21.0,  20.0,
 #   19.0,  18.0,  17.0,  16.0,  15.0,  14.0,  13.0,  12.0,  11.0,  10.0,   9.0,   8.0,   7.0,   6.0,
 #    5.0,   4.0,   3.0,   2.0,   1.0,   0.0,   1.0,   2.0,   3.0,   4.0,   5.0,   6.0],
 # [ 34.0,  33.0,  32.0,  31.0,  30.0,  29.0,  28.0,  27.0,  26.0,  25.0,  24.0,  23.0,  22.0,  21.0,
 #   20.0,  19.0,  18.0,  17.0,  16.0,  15.0,  14.0,  13.0,  12.0,  11.0,  10.0,   9.0,   8.0,   7.0,
 #    6.0,   5.0,   4.0,   3.0,   2.0,   1.0,   0.0,   1.0,   2.0,   3.0,   4.0,   5.0],
 # [ 35.0,  34.0,  33.0,  32.0,  31.0,  30.0,  29.0,  28.0,  27.0,  26.0,  25.0,  24.0,  23.0,  22.0,
 #   21.0,  20.0,  19.0,  18.0,  17.0,  16.0,  15.0,  14.0,  13.0,  12.0,  11.0,  10.0,   9.0,   8.0,
 #    7.0,   6.0,   5.0,   4.0,   3.0,   2.0,   1.0,   0.0,   1.0,   2.0,   3.0,   4.0],
 # [ 36.0,  35.0,  34.0,  33.0,  32.0,  31.0,  30.0,  29.0,  28.0,  27.0,  26.0,  25.0,  24.0,  23.0,
 #   22.0,  21.0,  20.0,  19.0,  18.0,  17.0,  16.0,  15.0,  14.0,  13.0,  12.0,  11.0,  10.0,   9.0,
 #    8.0,   7.0,   6.0,   5.0,   4.0,   3.0,   2.0,   1.0,   0.0,   1.0,   2.0,   3.0],
 # [ 37.0,  36.0,  35.0,  34.0,  33.0,  32.0,  31.0,  30.0,  29.0,  28.0,  27.0,  26.0,  25.0,  24.0,
 #   23.0,  22.0,  21.0,  20.0,  19.0,  18.0,  17.0,  16.0,  15.0,  14.0,  13.0,  12.0,  11.0,  10.0,
 #    9.0,   8.0,   7.0,   6.0,   5.0,   4.0,   3.0,   2.0,   1.0,   0.0,   1.0,   2.0],
 # [ 38.0,  37.0,  36.0,  35.0,  34.0,  33.0,  32.0,  31.0,  30.0,  29.0,  28.0,  27.0,  26.0,  25.0,
 #   24.0,  23.0,  22.0,  21.0,  20.0,  19.0,  18.0,  17.0,  16.0,  15.0,  14.0,  13.0,  12.0,  11.0,
 #   10.0,   9.0,   8.0,   7.0,   6.0,   5.0,   4.0,   3.0,   2.0,   1.0,   0.0,   1.0],
 # [ 39.0,  38.0,  37.0,  36.0,  35.0,  34.0,  33.0,  32.0,  31.0,  30.0,  29.0,  28.0,  27.0,  26.0,
 #   25.0,  24.0,  23.0,  22.0,  21.0,  20.0,  19.0,  18.0,  17.0,  16.0,  15.0,  14.0,  13.0,  12.0,
 #   11.0,  10.0,   9.0,   8.0,   7.0,   6.0,   5.0,   4.0,   3.0,   2.0,   1.0,   0.0]])
 #    print(emd(first_signature, second_signature, distance_matrix))